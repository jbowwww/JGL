using System;
using Gtk;
using System.Threading;
using JGL.Heirarchy;

namespace Dynamic.UI
{
	public class ProjectWindow
	{
		/// <summary>
		/// The scene window thread.
		/// </summary>
		private Thread SceneWindowThread;
		private Scene newScene;

		public readonly Window GtkWindow;

		[Glade.Widget]
		protected ComboBox cbAssemblies;

		[Glade.Widget]
		protected Gtk.CheckMenuItem miViewHeirarchy;

		[Glade.Widget]
		protected Gtk.CheckMenuItem miViewFileSystem;

		protected HeirarchyDialog dlgHeirarchy;

		protected FileSystemDialog dlgFileSystem;

		/// <summary>
		/// Initializes a new instance of the <see cref="UI.ProjectWindow"/> class.
		/// </summary>
		public ProjectWindow()
		{
			Glade.XML gxml = new Glade.XML("/home/jk/Code/JGL/DynamicCodeTests/UI/Dynamic.glade", "ProjectWindow", null);
			gxml.Autoconnect(this);																				// load & autoconnect glade UI for a CodeWindow

			GtkWindow = miViewHeirarchy.Toplevel as Window;

			dlgHeirarchy = new HeirarchyDialog();
			//dlgFileSystem = new FileSystemDialog();
		}

		public void DeleteWindow(object sender, DeleteEventArgs args)
		{
			Gtk.Application.Quit();
		}

		public void AddAssembly(object sender, EventArgs args)
		{
			FileChooserDialog fDlg = new FileChooserDialog("Add Assembly", GtkWindow, FileChooserAction.Open, "Cancel", ResponseType.Cancel, "Open", ResponseType.Accept);
			if (fDlg.Run() == (int)ResponseType.Accept)
			{
				cbAssemblies.InsertText(cbAssemblies.Children.Length - 1, fDlg.Filename);
				cbAssemblies.ShowAll();
			}
			fDlg.Destroy();
		}

		public void RemoveAssembly(object sender, EventArgs args)
		{
			if (cbAssemblies.Active >= 0)
				cbAssemblies.RemoveText(cbAssemblies.Active);
		}

		public void ViewHeirarchy(object sender, EventArgs args)
		{
			if (miViewHeirarchy.Active)
				dlgHeirarchy.GtkDialog.Show();
			else
				dlgHeirarchy.GtkDialog.Hide();
		}

		public void ViewFileSystem(object sender, EventArgs args)
		{
//			if (miViewFileSystem.Active)
//				dlgFileSystem.GtkDialog.Show();
//			else
//				dlgFileSystem.GtkDialog.Hide();
		}
	}
}

